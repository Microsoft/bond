# Core unit tests don't build under VS2013 without this.
cxx_add_compile_options(MSVC /EHa)

if (NOT BOND_SKIP_COMPAT_TESTS)
    add_subfolder (compat/core "tests/compat/core")
endif()

if (Boost_UNIT_TEST_FRAMEWORK_FOUND)
    if (NOT BOND_SKIP_CORE_TESTS)
        add_subfolder (core "tests/unit_test/core")
    endif()
    if (BOND_ENABLE_COMM)
        add_subfolder (comm "tests/unit_test/comm")
        add_subfolder (comm/epoxy "tests/unit_test/comm/epoxy")
        if (NOT BOND_SKIP_COMPAT_TESTS)
            add_subfolder (compat/comm "tests/compat/comm")
        endif()
    endif()
    if (BOND_ENABLE_GRPC)
        if (NOT BOND_SKIP_COMPAT_TESTS)
            add_subfolder (compat/grpc "tests/compat/grpc")
        endif()
        add_subfolder (grpc "tests/unit_test/grpc")
    endif()
endif()
